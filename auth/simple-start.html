<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Start OAuth</title>
</head>
<body>
  <script src="https://statics.teams.cdn.office.net/sdk/v2.0.0/js/MicrosoftTeams.min.js"></script>
  <script>
    const { app } = microsoftTeams;

    app.getContext().then((context) => {
      const state = Math.random().toString(36).substr(2);
      localStorage.setItem("simple.state", state);
      localStorage.removeItem("simple.error");

      const params = new URLSearchParams({
        client_id: "890ba6bd-4633-40cd-b3a3-48ee278c9a98",
        response_type: "id_token token",
        response_mode: "fragment",
        scope: "https://graph.microsoft.com/User.Read openid",
        redirect_uri: window.location.origin + "/auth/simple-end",
        nonce: Math.random().toString(36).substr(2),
        state: state,
        login_hint: context.user.loginHint
      });

      const authority = `https://login.microsoftonline.com/${context.user.tenant.id}/oauth2/v2.0/authorize`;
      window.location.assign(`${authority}?${params.toString()}`);
    });
  </script>
</body>
</html>